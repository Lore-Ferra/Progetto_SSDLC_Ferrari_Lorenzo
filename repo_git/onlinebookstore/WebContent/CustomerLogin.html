<!DOCTYPE html>
<html lang="en" xml:lang="en">
  <head>
    <meta charset="ISO-8859-1" />
    <title>Book Store</title>
    <link rel="apple-touch-icon" sizes="180x180" href="./favicons/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="./favicons/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="./favicons/favicon-16x16.png" />
    <link rel="manifest" href="./favicons/site.webmanifest" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="styles.css" />
    <style>
      .capbox {
        background: linear-gradient(to right, #ccc2a7, #8f8874);
        border: 2px solid #5c574b;
        border-left-width: 20px;
        display: inline-block;
        padding: 5px 8px;
        border-radius: 4px;
      }
      .capbox-inner {
        font: bold 12px arial, sans-serif;
        color: #000;
        background: rgba(255, 255, 255, 0.3);
        padding: 3px 8px 5px 10px;
        border-radius: 4px;
        display: inline-block;
        vertical-align: middle;
      }
      #CaptchaDiv {
        font: italic 25px Impact, Charcoal, sans-serif;
        text-align: center;
        background-color: #fff;
        padding: 3px 14px;
        border-radius: 4px;
        user-select: none;
      }
      #CaptchaInput {
        border: 2px solid black;
        margin: 3px 0;
        width: 105px;
      }
      input {
        padding: 2px;
        margin: 2px 0;
        box-sizing: border-box;
        border-radius: 10px;
      }
    </style>
    <script>
      var activeTab = "login";
    </script>
  </head>
  <body onload="funload()">
    <div id="navbar-placeholder"></div>

    <div id="topmid">
      <h1>Welcome to Online Book Store</h1>
    </div>

    <form action="userlog" method="post" onsubmit="return checkform()" id="theform">
      <table class="tab" style="width: 40%">
        <thead>
          <tr>
            <th colspan="2" style="color: brown; text-align: center">Customer LOGIN</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <a href="SellerLogin.html" style="color: blue; font-size: medium">
                Are you Seller? Click Here to Login as Admin
              </a>
            </td>
          </tr>
          <tr>
            <td>
              <label for="userName">Username:</label>
              <input type="text" name="username" id="userName" placeholder="Enter your Username" /><br /><br />
              <label for="Password">Password:</label>
              <input type="password" name="password" id="Password" placeholder="Enter Password" /><br /><br />

              <div class="capbox">
                <div id="CaptchaDiv">00000</div>
                <div class="capbox-inner">
                  <input type="hidden" id="txtCaptcha" value="" />
                  <input type="text" name="CaptchaInput" id="CaptchaInput" placeholder="Enter Captcha" />
                </div>
              </div>
              <br /><br />
              <input class="btn btn-success" type="submit" value="Login as a User" />
            </td>
          </tr>
        </tbody>
      </table>
    </form>
    <div id="external-scripts"></div>
    <script src="scripts/common.js"></script>
    <script>
      fetch("external-scripts.html")
        .then((res) => res.text())
        .then((data) => {
          document.getElementById("external-scripts").innerHTML = data;
        });

      fetch("navbar.html")
        .then((res) => res.text())
        .then((data) => {
          document.getElementById("navbar-placeholder").innerHTML = data;
          const active = document.getElementById(activeTab);
          if (active) active.classList.add("active");
        });

      function checkform() {
        const input = document.getElementById("CaptchaInput").value.trim();
        const expected = document.getElementById("txtCaptcha").value.trim();
        if (!input) {
          alert("- Please enter CAPTCHA code.");
          return false;
        }
        if (input !== expected) {
          alert("- The CAPTCHA code does not match.");
          return false;
        }
        return true;
      }

      function funload() {
        const code = generateCaptcha(5);
        document.getElementById("txtCaptcha").value = code;
        document.getElementById("CaptchaDiv").innerText = code;
      }

      function generateCaptcha(length = 5) {
        const arr = new Uint8Array(length);
        window.crypto.getRandomValues(arr);
        return Array.from(arr, (x) => (x % 10).toString()).join("");
      }
    </script>
  </body>
</html>
